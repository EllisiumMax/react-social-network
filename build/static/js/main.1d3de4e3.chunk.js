(this["webpackJsonpreact-social-network"]=this["webpackJsonpreact-social-network"]||[]).push([[0],{12:function(e,t,n){e.exports={messageWrapper:"Message_messageWrapper__36R4N",user:"Message_user__-Ob5z",text:"Message_text__t46C2",container:"Message_container__L4LEP",time:"Message_time__2T9dj",self:"Message_self__1DcSV",anotherUser:"Message_anotherUser__HdIPS",isViewed:"Message_isViewed__1bJ0u",contextMenu:"Message_contextMenu__3slGW"}},14:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i}));var s=function(e){return e.auth.isLogged},a=function(e){return e.auth.login},r=function(e){return e.auth.isFetching},c=function(e){return e.auth.errorCodes},u=function(e){return e.auth.errorMessages},o=function(e){return e.auth.captcha},i=function(e){return e.auth.id}},16:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return f}));var s=n(3),a=n(4),r="LOGIN-REQ",c="SERVER-ERROR",u="CAPTCHA",o={isLogged:!1,id:null,login:null,email:null,messages:[],isFetching:!1,errorMessages:null,errorCodes:null,captcha:null};function i(e,t,n,s,a){return{type:"LOGIN-REQ",login:e,id:t,email:n,messages:s,isLogged:a}}function l(e,t){return{type:c,messages:e,code:t}}function d(){return function(e){return a.a.auth.authRequest().then((function(t){0===t.resultCode&&e(i(t.data.login,t.data.id,t.data.email,t.data.messages,!0))}))}}function g(e){return function(t){a.a.auth.login(e).then((function(e){0===e.resultCode?(d(),a.a.auth.authRequest().then((function(e){0===e.resultCode&&t(i(e.data.login,e.data.id,e.data.email,e.data.messages,!0))}))):10===e.resultCode?(t(l(e.messages,e.resultCode)),a.a.auth.getCaptcha().then((function(e){return t((n=e.url,{type:u,url:n}));var n}))):t(l(e.messages,e.resultCode))}))}}function f(){return function(e){a.a.auth.logout().then((function(t){0===t.resultCode&&e(i(null,null,null,[],!1))}))}}t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0,n=Object(s.a)({},e);switch(t.type){case r:return n.isLogged=t.isLogged,n.login=t.login,n.id=t.id,n.email=t.email,n.messages=t.messages,n;case c:return n.errorMessages=t.messages,n.errorCodes=t.code,setTimeout((function(){n.errorMessages=n.errorCodes=null}),0),n;case u:return n.captcha=t.url,setTimeout((function(){n.captcha=n.errorMessages=n.errorCodes=null}),0),n;default:return e}}},17:function(e,t,n){e.exports={mainWrapper:"Chat_mainWrapper__3Zhbm",chat:"Chat_chat__3TtEy",welcomeMessage:"Chat_welcomeMessage__1IJK3",inputWindow:"Chat_inputWindow__3Wr9T",blankSpace:"Chat_blankSpace__1F6yl",preload:"Chat_preload__2aRqy"}},18:function(e,t,n){e.exports={wrapper:"User_wrapper__1wFGK",container:"User_container__2D4vm",avatar:"User_avatar__2YDBq",active:"User_active__1bOFJ",newMessagesWrapper:"User_newMessagesWrapper__3NSI8",newMessage:"User_newMessage__Qnvzl",newMessagesCount:"User_newMessagesCount__2XWU0"}},20:function(e,t,n){e.exports={container:"Navbar_container__1_ue6",nav:"Navbar_nav__3UMRc",active:"Navbar_active__1KUtM"}},29:function(e,t,n){e.exports={header:"Header_header__1zvcz",logInOutWrapper:"Header_logInOutWrapper__3m6Os"}},30:function(e,t,n){"use strict";n(0);var s=n.p+"static/media/loader.6aaaa7bc.svg",a=n(37),r=n.n(a),c=n(1);t.a=function(e){var t=e.fullscreen,n=void 0!==t&&t;return Object(c.jsx)("div",{className:r.a.loaderWrapper,children:Object(c.jsx)("img",{className:n?r.a.fullScreenLoader:r.a.loader,src:s,alt:"LOADING..."})})}},37:function(e,t,n){e.exports={loaderWrapper:"Loader_loaderWrapper__3XmWS",loader:"Loader_loader__1w7OH",fullScreenLoader:"Loader_fullScreenLoader__3H8A5"}},4:function(e,t,n){"use strict";var s=n(3),a=n(60),r=n.n(a).a.create({baseURL:"https://social-network.samuraijs.com/api/1.0/",withCredentials:!0,headers:{"API-KEY":"7bc71dc4-bd30-40b8-a02a-666b7e04e450"}}),c={security:{},auth:{authRequest:function(){return r.get("auth/me").then((function(e){return e.data}))},login:function(e){return r.post("auth/login",e).then((function(e){return e.data}))},logout:function(){return r.delete("/auth/login").then((function(e){return e.data}))},getCaptcha:function(){return r.get("/security/get-captcha-url").then((function(e){return e.data}))}},users:{getUsers:function(e,t){return r.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},loadPage:function(e,t){return r.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},loadNextPage:function(e,t){return r.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},loadPrevPage:function(e,t){return r.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},subscribeRequest:function(e){return r.post("https://social-network.samuraijs.com/api/1.0/follow/".concat(e)).then((function(e){return e.data}))},uNsubscribeRequest:function(e){return r.delete("https://social-network.samuraijs.com/api/1.0/follow/".concat(e)).then((function(e){return e.data}))}},profile:{loadProfileInfo:function(e){return r.get("profile/".concat(e)).then((function(e){return e.data}))},getStatus:function(e){return r.get("profile/status/".concat(e)).then((function(e){return e.data}))},setStatus:function(e){return r.put("profile/status",{status:e}).then((function(e){return e.data}))},uploadPhoto:function(e){var t=new FormData;return t.append("image",e.files[0]),r.put("profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data}))}},messages:{startChating:function(e){return r.put("dialogs/".concat(e)).then((function(e){return e.data}))},getAllDialogs:function(){return r.get("dialogs/").then((function(e){return e.data}))},getMessages:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return r.get("dialogs/".concat(e,"/messages?page=").concat(t,"&count=").concat(n)).then((function(e){return e.data}))},sendMessage:function(e,t){return r.post("dialogs/".concat(e,"/messages"),JSON.stringify(t),{headers:{"content-type":"application/json; charset=utf-8"}}).then((function(e){return e.data}))},checkMessageViewed:function(e){return r.get("dialogs/messages/".concat(e,"/viewed")).then((function(e){return e.data}))},markAsSpam:function(e){return r.post("dialogs/messages/".concat(e,"/spam")).then((function(e){return e.data}))},deleteMessage:function(e){return r.delete("dialogs/messages/".concat(e)).then((function(e){return e.data}))},restoreMessage:function(e){return r.put("dialogs/messages/".concat(e,"/restore")).then((function(e){return e.data}))},filterMessagesByDate:function(e,t){return r.get("dialogs/".concat(e,"/messages/new?newerThen=").concat(t)).then((function(e){return e.data}))},listOfNewMessages:function(){return r.get("dialogs/messages/new/count").then((function(e){return e.data}))}},settings:{changeProfileInfo:function(e){return r.put("profile",Object(s.a)({},e)).then((function(e){return e.data}))}}};t.a=c},42:function(e,t,n){e.exports={loginName:"Login_loginName__1xOxy",loginBtn:"Login_loginBtn__WqQGl"}},45:function(e,t,n){"use strict";var s=n(3),a=n(21),r=n(22),c=n(25),u=n(24),o=n(0),i=n.n(o),l=n(10),d=n(5),g=n(14),f=n(1);function p(e){return{isLogged:Object(g.g)(e),id:Object(g.f)(e)}}t.a=function(e){var t=function(t){Object(c.a)(o,t);var n=Object(u.a)(o);function o(){return Object(a.a)(this,o),n.apply(this,arguments)}return Object(r.a)(o,[{key:"render",value:function(){return this.props.isLogged?Object(f.jsx)(e,Object(s.a)({},this.props)):Object(f.jsx)(d.a,{to:"/login"})}}]),o}(i.a.Component);return Object(l.b)(p,{})(t)}},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return j})),n.d(t,"f",(function(){return O}));var s=n(15),a=n(3),r=n(4),c="ADD-POST",u="SET-PROFILE-INFO",o="GET-STATUS",i="SET-STATUS",l="REQUEST-IS-FETCHING",d="UPPLOAD-PHOTO",g={profileInfo:{photos:{small:null,large:null}},status:"",posts:[{imgLink:"https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg",date:"03.02.2021 12:41",text:"Hello World",likes:"25",id:1},{imgLink:"https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg",date:"03.02.2021 12:44",text:"Hello React",likes:"125",id:2},{imgLink:"https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg",date:"03.02.2021 12:41",text:"Hello JavaScript",likes:"1125",id:3},{imgLink:"https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg",date:"03.02.2021 12:41",text:"Hello Web",likes:"23",id:4}],isFetching:!1};function f(e,t){return{type:c,post:e,date:t}}function p(e){return{type:"REQUEST-IS-FETCHING",fetching:e}}function h(e){return{type:i,status:e}}function m(e){return function(t){t(p(!0)),r.a.profile.loadProfileInfo(e).then((function(e){t({type:"SET-PROFILE-INFO",profileInfo:e}),t(p(!1))}))}}function b(e){return function(t){r.a.profile.getStatus(e).then((function(e){t({type:o,status:e})}))}}function j(e,t){return function(n){e!==t&&""!==t&&t.length<=300?r.a.profile.setStatus(t).then((function(e){0===e.resultCode&&n(h(t))})):n(h(e))}}function O(e){return function(t){r.a.profile.uploadPhoto(e).then((function(e){var n;0===e.resultCode&&t((n=e.data.photos,{type:d,small:n.small,large:n.large}))}))}}t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,n=Object(a.a)({},e);switch(n.profileInfo=Object(a.a)({},e.profileInfo),n.profileInfo.photos=Object(a.a)({},e.profileInfo.photos),n.posts=Object(s.a)(e.posts),t.type){case c:var r={imgLink:"https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg",date:t.date,text:t.post,likes:"0"};return n.posts.push(r),n;case u:return n.profileInfo=t.profileInfo,n;case l:return n.isFetching=t.fetching,n;case o:case i:return n.status=t.status,n;case d:return n.profileInfo.photos.small=t.small,n.profileInfo.photos.large=t.large,n;default:return e}}},56:function(e,t,n){"use strict";t.a=n.p+"static/media/unknown-user.2a8085fe.svg"},57:function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return M})),n.d(t,"g",(function(){return N}));var s=n(15),a=n(3),r=n(4),c="SET-USERS",u="SET-SUBSCRIBE",o="SET-UN-SUBSCRIBE",i="SET-TOTAL-USERS",l="SET-CURRENT-PAGE",d="REQUEST-IS-FETCHING",g="ADD-FOLLOW-UNFOLLOW-REQUEST",f="REMOVE-FOLLOW-UNFOLLOW-REQUEST",p={users:[],totalCount:0,usersPerPage:8,currentPage:1,isFetching:!0,currentRequests:[]};function h(e){return{type:c,users:e}}function m(e){return{type:i,totalCount:e}}function b(e){return{type:l,currentPage:e}}function j(e){return{type:d,isFetching:e}}function O(e){return{type:g,id:e}}function v(e){return{type:f,id:e}}function _(e,t){return function(n){n(j(!0)),r.a.users.getUsers(e,t).then((function(e){n(j(!1)),n(h(e.items)),n(m(e.totalCount))}))}}function x(e,t,n){return function(s){e!==t&&(s(j(!0)),r.a.users.loadPage(e,n).then((function(e){s(j(!1)),s(h(e.items)),s(m(e.totalCount))})),s(b(e)))}}function S(e,t,n){return function(s){var a=Math.ceil(e/t),c=n+1;c<=a&&(s(j(!0)),r.a.users.loadNextPage(c,t).then((function(e){s(j(!1)),s(h(e.items)),s(m(e.totalCount)),s(b(c))})))}}function I(e,t){return function(n){var s=e-1;s>=1&&(n(j(!0)),r.a.users.loadPrevPage(s,t).then((function(e){n(h(e.items)),n(m(e.totalCount)),n(j(!1)),n(b(s))})))}}function M(e){return function(t){t(O(e)),r.a.users.subscribeRequest(e).then((function(n){0===n.resultCode&&t({type:u,userID:e}),t(v(e))}))}}function N(e){return function(t){t(O(e)),r.a.users.uNsubscribeRequest(e).then((function(n){0===n.resultCode&&t({type:o,userID:e}),t(v(e))}))}}t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,n=Object(a.a)({},e);switch(n.users=Object(s.a)(e.users),n.currentRequests=Object(s.a)(e.currentRequests),t.type){case c:return n.users=t.users,n;case u:return n.users.forEach((function(e){e.id===t.userID&&(e.followed=!0)})),n;case o:return n.users.forEach((function(e){e.id===t.userID&&(e.followed=!1)})),n;case i:return n.totalCount=t.totalCount,n;case l:return n.currentPage=t.currentPage,n;case d:return n.isFetching=t.isFetching,n;case g:return n.currentRequests.push(t.id),n;case f:return n.currentRequests=n.currentRequests.filter((function(e){return e!==t.id})),n;default:return e}}},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var s=n(15),a=n(3),r=n(4),c="ERROR-ON-SUBMIT",u="SENT-SUCESSFULLY",o="IS-FETCHING",i="HIDE-NOTIFICATIONS",l={messages:[],sentSucessfully:!1,isFetching:!1};function d(e){return{type:o,boolean:e}}function g(e){return function(t){t(d(!0)),r.a.settings.changeProfileInfo(e).then((function(e){var n;0===e.resultCode?t({type:u}):t((n=e.messages,{type:c,messages:n}))})).then((function(){t(d(!1)),window.setTimeout((function(){return t({type:i})}),5500)}))}}t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0,n=Object(a.a)({},e);switch(n.messages=Object(s.a)(e.messages),t.type){case c:return n.messages=t.messages,n.sentSucessfully=!1,n;case u:return n.sentSucessfully=!0,n.messages=[],n;case o:return n.isFetching=t.boolean,n;case i:return n.sentSucessfully=!1,n.messages=[],n;default:return e}}},61:function(e,t,n){e.exports={logout:"Logout_logout__1DQkS"}},63:function(e,t,n){e.exports={chatWrapper:"Messages_chatWrapper__tzRIL"}},64:function(e,t,n){e.exports={users:"UserList_users__2I2wg"}},71:function(e,t,n){},72:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),r=n(32),c=n.n(r),u=(n(71),n(21)),o=n(22),i=n(25),l=n(24),d=n(11),g=n(5),f=(n(72),n(29)),p=n.n(f),h=n.p+"static/media/toucan.85b0421a.svg",m=n(3),b=n(10),j=n(16),O=n(14),v=n(42),_=n.n(v),x=n(1);var S=function(e){return e.isLogged?Object(x.jsx)("p",{className:_.a.loginName,children:e.login}):Object(x.jsx)(d.b,{to:"/login",className:_.a.loginBtn,onClick:function(){return e.authRequest()},children:"Login"})},I=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(x.jsx)(S,Object(m.a)({},this.props))}}]),n}(a.a.Component);var M=Object(b.b)((function(e){return{isLogged:Object(O.g)(e),login:Object(O.e)(e),isFetching:Object(O.d)(e)}}),{authRequest:j.a})(I),N=n(61),C=n.n(N);var y=function(e){return Object(x.jsxs)("button",{className:C.a.logout,onClick:function(){return e.logout()},children:["LOG ",Object(x.jsx)("br",{})," OUT"]})};var w=Object(b.b)((function(e){return{isLogged:Object(O.g)(e)}}),{logout:j.d})((function(e){return e.isLogged?Object(x.jsx)(y,Object(m.a)({},e)):null}));var E=function(){return Object(x.jsxs)("header",{className:p.a.header,children:[Object(x.jsx)("img",{src:h,alt:"toucan"}),Object(x.jsx)("p",{children:"Toucan Social Network"}),Object(x.jsxs)("div",{className:p.a.logInOutWrapper,children:[Object(x.jsx)(M,{className:p.a.logIn}),Object(x.jsx)(w,{className:p.a.logOut})]})]})},L=n(20),R=n.n(L);var k=function(){return Object(x.jsx)("div",{className:R.a.container,children:Object(x.jsxs)("nav",{className:R.a.nav,children:[Object(x.jsx)(d.b,{to:"/profile",activeClassName:R.a.active,children:"Profile"}),Object(x.jsx)(d.b,{to:"/messages",activeClassName:R.a.active,children:"Messages"}),Object(x.jsx)(d.b,{to:"/users",activeClassName:R.a.active,children:"Users"}),Object(x.jsx)(d.b,{to:"/settings",activeClassName:R.a.active,children:"Settings"})]})})},T=n(19),U=n(45),P=n(13),A=n(15),F=n(4),W=n(62),D=n.n(W),G=n(28),H=n.n(G),q="SEND-MESSAGE",z="GET-DIALOGS-LIST",B="GET-MESSAGES",V="DELETE-MESSAGE",Q="MARK-SPAM",J="IS-MESSAGES-FETCHING",Y={isMessagesFetch:!1,userList:[],messages:{items:[]},targetUserId:null};function K(e){return{type:J,boolean:e}}var X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0,n=JSON.parse(JSON.stringify(e));switch(t.type){case q:return n.messages.items.push(t.message),n;case V:return n.messages.items=n.messages.items.filter((function(e){return e.id!==t.messageId})),n;case Q:return n;case z:return n.userList=Object(A.a)(t.users),n;case B:return n.targetUserId!=t.targetUserId?(n.targetUserId=t.targetUserId,n.messages.items=t.messages.items):n.messages.items=D.a.unionWith(n.messages.items,t.messages.items,(function(e,t){return e.id==t.id})).sort((function(e,t){return H()(e.addedAt)-H()(t.addedAt)})),n.messages.totalCount=t.messages.totalCount,n;case J:return n.isMessagesFetch=t.boolean,n;default:return n}},Z=function(e){return e.messagesPage.userList},$=function(e){return e.messagesPage.messages},ee=function(e){return e.messagesPage.isMessagesFetch},te=n(17),ne=n.n(te),se=n(12),ae=n.n(se),re=n.p+"static/media/viewed.89e68a95.svg",ce=n.p+"static/media/not_viewed.f10d84c9.svg";var ue=function(e){var t=H.a.utc(e.timeStamp).local().format("DD.MM.YYYY, HH:mm:ss"),n=Object(s.useState)(!1),a=Object(T.a)(n,2),r=a[0],c=a[1];return window.addEventListener("click",(function(){r&&c(!1)})),Object(x.jsxs)("div",{onClick:function(){c(!1)},onContextMenu:function(e){e.preventDefault(),c(!r)},className:e.self?"".concat(ae.a.messageWrapper," ").concat(ae.a.self):"".concat(ae.a.messageWrapper," ").concat(ae.a.anotherUser),children:[r?Object(x.jsxs)("div",{className:ae.a.contextMenu,children:[Object(x.jsx)("p",{onClick:function(){return e.deleteMessage(e.id)},children:"Delete message"}),Object(x.jsx)("p",{onClick:function(){return e.markAsSpam(e.id)},children:"Mark as SPAM"})]}):null,Object(x.jsx)("p",{className:ae.a.user,children:e.userName}),Object(x.jsx)("p",{className:ae.a.text,children:e.text}),Object(x.jsx)("p",{className:ae.a.time,children:t}),e.viewed&&e.self&&Object(x.jsx)("img",{className:ae.a.isViewed,src:re,alt:"viewed"}),!e.viewed&&e.self&&Object(x.jsx)("img",{className:ae.a.isViewed,src:ce,alt:"not viewed"})]})},oe=n(40),ie=n.p+"static/media/puff_color.54b9c84f.svg";var le=function(e){return Object(x.jsx)(oe.b,{onSubmit:function(t,n){t.message&&(e.sendMessage(+e.friendId,{body:t.message}),n.reset(),e.blankSpace&&e.blankSpace.scrollIntoView({behavior:"smooth",block:"end"}))},render:function(e){var t=e.handleSubmit,n=e.submitting;return Object(x.jsx)("form",{onSubmit:t,children:Object(x.jsxs)("div",{className:ne.a.inputWindow,children:[Object(x.jsx)(oe.a,{name:"message",component:"input",type:"text",maxLength:5e3,placeholder:"Input your message..",autoComplete:"off"}),Object(x.jsx)("button",{disabled:n,children:"SEND"})]})})}})},de=function(e){var t=Math.ceil(e.messages.totalCount/20),n=Object(x.jsx)("p",{className:ne.a.welcomeMessage,children:"No messages yet.."}),a=Object(s.useRef)(null),r=Object(s.useState)(1),c=Object(T.a)(r,2),u=c[0],o=c[1];return Object(s.useEffect)((function(){a.current&&a.current.scrollIntoView({behavior:"smooth"})}),[e.messages.totalCount]),Object(s.useEffect)((function(){a.current&&a.current.scrollIntoView({behavior:"smooth"})}),[e.friendId]),e.friendId?(e.messages.items.length>0&&(n=e.messages.items.map((function(t,n){return t.senderId!==e.loggedId?Object(x.jsx)(ue,{id:t.id,userName:t.senderName,text:t.body,timeStamp:t.addedAt,self:!1,deleteMessage:e.deleteMessage,markAsSpam:e.markAsSpam},t.id):Object(x.jsx)(ue,{id:t.id,userName:"You",text:t.body,timeStamp:t.addedAt,self:!0,viewed:t.viewed,deleteMessage:e.deleteMessage,markAsSpam:e.markAsSpam},t.id)}))),Object(x.jsxs)("div",{className:ne.a.mainWrapper,children:[Object(x.jsx)("img",{src:ie,alt:"loader",style:{display:"none"}}),e.isFetching?Object(x.jsx)("img",{className:ne.a.preload,src:ie,alt:"loader"}):Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{onScroll:function(n){return function(n){n.target.scrollTop<1&&(u<t?(o(++u),e.getMessages(e.friendId,u,20),n.target.scrollTop=200):o(--u))}(n)},className:ne.a.chat,children:[n,Object(x.jsx)("div",{ref:a,className:ne.a.blankSpace})]}),Object(x.jsx)(le,Object(m.a)(Object(m.a)({},e),{},{blankSpace:a.current}))]})]})):Object(x.jsx)("div",{className:ne.a.welcomeMessage,children:" Select user to start chat"})},ge=n(63),fe=n.n(ge),pe=n(18),he=n.n(pe),me=n(56),be=n.p+"static/media/newMessage.59d9faef.svg";var je=function(e){var t="/messages/".concat(e.id);return Object(x.jsx)("div",{className:he.a.wrapper,onClick:function(){e.startChating(e.id),e.getMessages(e.id)},children:Object(x.jsx)(d.b,{to:t,activeClassName:he.a.active,children:Object(x.jsxs)("div",{className:he.a.container,children:[Object(x.jsx)("img",{className:he.a.avatar,src:e.photos.small||e.photos.large||me.a,alt:"User avatar"}),Object(x.jsx)("p",{children:e.userName}),e.hasNewMessages?Object(x.jsxs)("div",{className:he.a.newMessagesWrapper,children:[Object(x.jsx)("img",{className:he.a.newMessage,src:be,alt:"new message"}),Object(x.jsx)("p",{className:he.a.newMessagesCount,children:e.newMessagesCount})]}):null]})})})},Oe=n(64),ve=n.n(Oe);var _e=function(e){var t=e.userList.map((function(t,n){return Object(x.jsx)(je,Object(m.a)(Object(m.a)({},t),{},{getMessages:e.getMessages,startChating:e.startChating}),"user".concat(n))}));return Object(x.jsx)("div",{className:ve.a.users,children:t})};var xe=function(e){return Object(x.jsxs)("div",{className:fe.a.chatWrapper,children:[Object(x.jsx)(_e,{userList:e.userList,getMessages:e.getMessages,startChating:e.startChating}),Object(x.jsx)(de,{messages:e.messages,sendMessage:e.sendMessage,friendId:e.match.params.userId,loggedId:e.id,deleteMessage:e.deleteMessage,markAsSpam:e.markAsSpam,getMessages:e.getMessages,isFetching:e.isFetching})]})};var Se=Object(P.compose)(Object(b.b)((function(e){return{userList:Z(e),messages:$(e),isFetching:ee(e)}}),{getDialogs:function(){return function(e){F.a.messages.getAllDialogs().then((function(t){e({type:z,users:t})}))}},getMessages:function(e,t,n){return function(s){return F.a.messages.getMessages(e,t,n).then((function(t){s({type:B,messages:t,targetUserId:e})}))}},sendMessage:function(e,t){return function(n){return F.a.messages.sendMessage(e,t).then((function(e){var t;0===e.resultCode&&n((t=e.data.message,{type:q,message:t}))}))}},startChating:function(e){return function(t){return t(K(!0)),F.a.messages.startChating(e).then((function(){return t(K(!1))}))}},deleteMessage:function(e){return function(t){F.a.messages.deleteMessage(e).then((function(n){console.log(n),0===n.resultCode&&t(function(e){return{type:V,messageId:e}}(e))}))}},markAsSpam:function(e){return function(t){F.a.messages.markAsSpam(e).then((function(n){console.log(n),0===n.resultCode&&t({type:Q,messageID:e})}))}}}),U.a,g.f)((function(e){var t=Object(s.useState)(1),n=Object(T.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(!0),u=Object(T.a)(c,2),o=u[0],i=u[1];return Object(s.useEffect)((function(){e.getDialogs(),void 0!==e.match.params.userId&&(e.startChating(e.match.params.userId),e.getMessages(e.match.params.userId))}),[]),Object(s.useEffect)((function(){i(!0);var e=null;return o&&(e=setInterval((function(){r(++a)}),3e3)),function(){clearInterval(e),i(!1)}})),Object(s.useEffect)((function(){e.getDialogs(),void 0!==e.match.params.userId&&e.getMessages(e.match.params.userId)}),[a]),Object(x.jsx)(xe,Object(m.a)({},e))})),Ie=n(30),Me="INITIALIZE",Ne={appReady:!1};var Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0,n=Object(m.a)({},e);switch(t.type){case Me:return n.appReady=!0,n;default:return e}};var ye=function(e,t){return Object(x.jsx)(s.Suspense,{fallback:Object(x.jsx)(Ie.a,{}),children:Object(x.jsx)(e,Object(m.a)({},t))})},we=a.a.lazy((function(){return n.e(5).then(n.bind(null,111))})),Ee=a.a.lazy((function(){return n.e(4).then(n.bind(null,112))})),Le=a.a.lazy((function(){return n.e(3).then(n.bind(null,110))})),Re=a.a.lazy((function(){return n.e(6).then(n.bind(null,113))})),ke=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.appReady?Object(x.jsx)(d.a,{basename:"/toucan/",children:Object(x.jsxs)("div",{className:"app-wrapper",children:[Object(x.jsx)(E,{}),Object(x.jsx)(k,{}),Object(x.jsxs)("div",{className:"app-wrapper-content",children:[Object(x.jsx)(g.b,{path:"/profile/:userId?",render:function(){return ye(Le)}}),Object(x.jsx)(g.b,{path:"/messages/:userId?",render:function(){return Object(x.jsx)(Se,{})}}),Object(x.jsx)(g.b,{path:"/users",render:function(){return ye(we)}}),Object(x.jsx)(g.b,{path:"/settings",render:function(){return ye(Re)}}),Object(x.jsx)(g.b,{path:"/login",render:function(){return ye(Ee)}})]})]})}):Object(x.jsx)(Ie.a,{fullscreen:!0})}}]),n}(a.a.Component),Te=Object(b.b)((function(e){return{appReady:e.app.appReady}}),{initializeApp:function(){return function(e){e(Object(j.a)()).then((function(){return e({type:Me})}))}}})(ke),Ue=n(46),Pe=n(57),Ae=n(65),Fe=n(66),We=n(58),De=Object(P.combineReducers)({profilePage:Ue.b,messagesPage:X,usersPage:Pe.a,auth:j.b,app:Ce,settingsPage:We.b}),Ge=Object(P.createStore)(De,Object(Fe.composeWithDevTools)(Object(P.applyMiddleware)(Ae.a)));c.a.render(Object(x.jsx)(b.a,{store:Ge,children:Object(x.jsx)(Te,{})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.1d3de4e3.chunk.js.map